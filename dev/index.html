<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>StochasticWeatherGenerators.jl · StochasticWeatherGenerators</title><meta name="title" content="StochasticWeatherGenerators.jl · StochasticWeatherGenerators"/><meta property="og:title" content="StochasticWeatherGenerators.jl · StochasticWeatherGenerators"/><meta property="twitter:title" content="StochasticWeatherGenerators.jl · StochasticWeatherGenerators"/><meta name="description" content="Documentation for StochasticWeatherGenerators."/><meta property="og:description" content="Documentation for StochasticWeatherGenerators."/><meta property="twitter:description" content="Documentation for StochasticWeatherGenerators."/><meta property="og:url" content="https://dmetivie.github.io/StochasticWeatherGenerators.jl/"/><meta property="twitter:url" content="https://dmetivie.github.io/StochasticWeatherGenerators.jl/"/><link rel="canonical" href="https://dmetivie.github.io/StochasticWeatherGenerators.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="StochasticWeatherGenerators logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>StochasticWeatherGenerators</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>StochasticWeatherGenerators.jl</a><ul class="internal"><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="examples/tuto_paper/">Multisite daily Stochastic Weather Generator</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>StochasticWeatherGenerators.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>StochasticWeatherGenerators.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="StochasticWeatherGenerators.jl"><a class="docs-heading-anchor" href="#StochasticWeatherGenerators.jl">StochasticWeatherGenerators.jl</a><a id="StochasticWeatherGenerators.jl-1"></a><a class="docs-heading-anchor-permalink" href="#StochasticWeatherGenerators.jl" title="Permalink"></a></h1><p>Documentation for StochasticWeatherGenerators.jl</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>In construction! Note that the main functions to fit HMM, AR etc are currently in <a href="https://github.com/dmetivie/SmoothPeriodicStatsModels.jl">SmoothPeriodicStatsModels.jl</a>. This will change when these packages are rebased.</p></div></div><p>A Julia package, to define, fit and use a Stochastic Weather Generator (SWG) as proposed in the <a href="https://hal.inrae.fr/hal-04621349"><em>Interpretable Seasonal Hidden Markov Model for spatio-temporal stochastic rain generation in France</em></a> paper.  This SWG relies on some &quot;Seasonal Hidden Markov Models&quot; currently implemented in the package <a href="https://github.com/dmetivie/SmoothPeriodicStatsModels.jl">SmoothPeriodicStatsModels.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The objective of this package is not only to show <em>my</em> model, but also to propose several classic (and newer) SWG model. Hence, <strong>feel free to open an issue or open PR</strong> with ideas and models. This would allow easy model comparison and, in some cases, combination. I&#39;ll try to implement the simple (and historic) model, i.e. the <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/wr017i001p00182">Richardson - Water resources research, 1981</a>.</p></div></div><p>Go check the <a href="https://dmetivie.github.io/StochasticWeatherGenerators.jl/dev/">documentation</a> and the fully <a href="https://dmetivie.github.io/StochasticWeatherGenerators.jl/dev/examples/tuto_paper/">reproducible tutorial</a> associated with the paper.</p><div class="admonition is-info"><header class="admonition-header">Stochastics Weather Generators</header><div class="admonition-body"><p>Stochastics Weather Generators are probabilistic weather models. Like random number generators, they can quickly generate multiple random sequences, except that the produced sequences correctly reproduce some statistics of interest, e.g. spatial-temporal correlations, extremes, etc. They can be used to study climate variability.</p></div></div><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><h3 id="Fit-function"><a class="docs-heading-anchor" href="#Fit-function">Fit function</a><a id="Fit-function-1"></a><a class="docs-heading-anchor-permalink" href="#Fit-function" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SmoothPeriodicStatsModels.fit_mle_stations" href="#SmoothPeriodicStatsModels.fit_mle_stations"><code>SmoothPeriodicStatsModels.fit_mle_stations</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_mle_stations(df::DataFrame, K, T, degree, local_order)</code></pre><p>Given a DataFrame <code>df</code> with known hidden states column <code>z ∈ 1:K</code>. The rain occurrences of the new station are fitted conditionally to the hidden state. For <code>local_order&gt;0</code> the model is also autoregressive with its past.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/fit_mle.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.fit_mle_RR" href="#StochasticWeatherGenerators.fit_mle_RR"><code>StochasticWeatherGenerators.fit_mle_RR</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_mle_RR(df::DataFrame, K, local_order; maxiter=5000, tol=2e-4, robust=true, silence=true, warm_start=true, display=:none, mix₀=mix_ini(T))</code></pre><pre><code class="language-julia hljs">mix_allE = fit_mle_RR.(data_stations, K, local_order)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/fit_mle.jl#L58-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.fit_TN" href="#StochasticWeatherGenerators.fit_TN"><code>StochasticWeatherGenerators.fit_TN</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_TN(df_full::DataFrame, 𝐃𝐞𝐠, T; kwargs...)</code></pre><p>Fit the variable <code>TN</code> (daily minimum temperature). In fact it fits the difference <code>ΔT = TX - TN</code> to ensure a positive difference between <code>TX</code> and <code>TN</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/temperature/fit_mle.jl#L2-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.fit_AR1" href="#StochasticWeatherGenerators.fit_AR1"><code>StochasticWeatherGenerators.fit_AR1</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_AR1(df_full::DataFrame, X, 𝐃𝐞𝐠, T, K)</code></pre><p>Fit a Seasonal AR(1) model of period <code>T</code> and with <code>K</code> hidden states for the variable <code>X</code> of the DataFrame <code>df_full</code>. <span>$X_{n+1} = \mu(t_n) + \phi(t_n) X_t + \sigma(t_n)\xi$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/AR1/fit_mle.jl#L3-L7">source</a></section></article><h3 id="Climate-indexes"><a class="docs-heading-anchor" href="#Climate-indexes">Climate indexes</a><a id="Climate-indexes-1"></a><a class="docs-heading-anchor-permalink" href="#Climate-indexes" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.VCX3" href="#StochasticWeatherGenerators.VCX3"><code>StochasticWeatherGenerators.VCX3</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VCX3(df; y_col, nb = 3)</code></pre><p>Yearly Max of <code>nb = 3</code> days sliding mean for <code>y</code> for every year.  By default, <code>y_col</code> is the first column not with a <code>Date</code> type</p><pre><code class="language-julia hljs">using DataFrames, Dates, RollingFunctions
time_range = Date(1956):Day(1):Date(2019,12,31)
df = DataFrame(:DATE =&gt; time_range, :Temperature =&gt; 20 .+ 5*randn(length(time_range)))
VCX3(df)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/climate_indices.jl#L26-L37">source</a></section><section><div><pre><code class="language-julia hljs">VCX3(y, idxs; nb = 3)</code></pre><p>Yearly Max of <code>nb = 3</code> days sliding mean for <code>y</code>. Here <code>idxs</code> can be a vector of vector (or range) corresponds to the index of every year.</p><pre><code class="language-julia hljs">using DataFrames, Dates, RollingFunctions
time_range = Date(1956):Day(1):Date(2019,12,31)
year_range = unique(year.(time_range))
df = DataFrame(:DATE =&gt; time_range, :Temperature =&gt; 20 .+ 5*randn(length(time_range)))
idx_year = [findall(x-&gt; year.(x) == m, df[:, :DATE]) for m in year_range]
VCX3(df.Temperature, idx_year)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/climate_indices.jl#L49-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.cum_monthly" href="#StochasticWeatherGenerators.cum_monthly"><code>StochasticWeatherGenerators.cum_monthly</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cum_monthly(y::AbstractArray, idxs)</code></pre><pre><code class="language-julia hljs">using DataFrames, Dates, RollingFunctions
time_range = Date(1956):Day(1):Date(2019,12,31)
year_range = unique(year.(time_range))
df = DataFrame(:DATE =&gt; time_range, :Temperature =&gt; 20 .+ 5*randn(length(time_range)))
idx_year = [findall(x-&gt; year.(x) == m, df[:, :DATE]) for m in year_range]
idx_month = [findall(x-&gt; month.(x) == m, df[:, :DATE]) for m in 1:12]
idx_all = [intersect(yea, mon) for yea in idx_year, mon in idx_month]
cum_monthly(y, idx_all)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/climate_indices.jl#L66-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.corTail" href="#StochasticWeatherGenerators.corTail"><code>StochasticWeatherGenerators.corTail</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">corTail(x::AbstractMatrix, q = 0.95)</code></pre><p>Compute the (symmetric averaged) tail index matrix <code>M</code> of a vector x, i.e. M[i, j] = (ℙ(x[:,j] &gt; Fxⱼ(q) ∣ x[:,i] &gt; Fxᵢ(q)) + ℙ(x[:,i] &gt; Fxᵢ(q) ∣ x[:,j] &gt; Fxⱼ(q)))/2 where Fx(q) is the CDF of x. Note it uses the same convention as <code>cor</code> function i.e. observations in rows and features in column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/correlations.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.longuest_spell" href="#StochasticWeatherGenerators.longuest_spell"><code>StochasticWeatherGenerators.longuest_spell</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">longuest_spell(y::AbstractArray; value=0)</code></pre><p>Compute the length of the longuest consecutive sequence of <code>value</code> in <code>y</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/climate_indices.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.pmf_spell" href="#StochasticWeatherGenerators.pmf_spell"><code>StochasticWeatherGenerators.pmf_spell</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pmf_spell(y::AbstractVector, value)</code></pre><p>Return the distribution of spells (consecutive sequence of with the same value) length of <code>value</code> in <code>y</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/climate_indices.jl#L15-L18">source</a></section></article><h3 id="Simulations"><a class="docs-heading-anchor" href="#Simulations">Simulations</a><a id="Simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Simulations" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.rand_RR" href="#StochasticWeatherGenerators.rand_RR"><code>StochasticWeatherGenerators.rand_RR</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_RR(mixs::AbstractArray{&lt;:MixtureModel}, n2t::AbstractVector, z::AbstractVector, y::AbstractMatrix, Σk::AbstractArray)</code></pre><p>Generate a (nonhomegenous) sequence of length <code>length(n2t)</code> of rain amounts conditionally to a given dry/wet matrix <code>y</code> and (hidden) state sequence <code>z</code>. Univariate distribution are given by <code>mixs</code> while correlations are given by covariance matrix Σk.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/generation.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.rand_cond" href="#StochasticWeatherGenerators.rand_cond"><code>StochasticWeatherGenerators.rand_cond</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_cond(ϵ, z, θ_uni, θ_cor, n2t, T)</code></pre><p>Genererate a random variable conditionnaly to another one Using Copula</p><p class="math-container">\[X_1 \mid X_2 = ϵ \sim \mathcal{N}\left(\mu_1 + \dfrac{\sigma_1}{\sigma_2}\rho (a - \mu_2), (1-\rho^2)\sigma_1^2 \right)\]</p><p>For two N(0,1)</p><p class="math-container">\[X_1 \mid X_2 = ϵ \sim \mathcal{N}\left(\rho a , (1-\rho^2) \right)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/temperature/correlations.jl#L42-L53">source</a></section></article><h3 id="Correlation-utilities"><a class="docs-heading-anchor" href="#Correlation-utilities">Correlation utilities</a><a id="Correlation-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Correlation-utilities" title="Permalink"></a></h3><h4 id="For-temperature"><a class="docs-heading-anchor" href="#For-temperature">For temperature</a><a id="For-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#For-temperature" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.cor_groupby" href="#StochasticWeatherGenerators.cor_groupby"><code>StochasticWeatherGenerators.cor_groupby</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Compute and fit the `cor` between two `var` with a smooth function for each `z`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/temperature/correlations.jl#L3-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.cor_groupbyTXTN" href="#StochasticWeatherGenerators.cor_groupbyTXTN"><code>StochasticWeatherGenerators.cor_groupbyTXTN</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Compute and fit the `cor` between `:TX` and `:TX-:TN` with a smooth function for each `z`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/temperature/correlations.jl#L22-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.cov_ar1" href="#StochasticWeatherGenerators.cov_ar1"><code>StochasticWeatherGenerators.cov_ar1</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Fit residual to constant (in time) cov matrices for each weather regime Example:</p><pre><code class="language-julia hljs">cov_ar1(data_stations, ar1sTX, :TX, K)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/AR1/fit_mle.jl#L37-L43">source</a></section></article><h4 id="For-rain"><a class="docs-heading-anchor" href="#For-rain">For rain</a><a id="For-rain-1"></a><a class="docs-heading-anchor-permalink" href="#For-rain" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.cov_RR" href="#StochasticWeatherGenerators.cov_RR"><code>StochasticWeatherGenerators.cov_RR</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cov_RR(dfs::AbstractArray{&lt;:DataFrame}, K)</code></pre><p>Each df must have :DATE, :RR, :z (same :z for each df)</p><pre><code class="language-julia hljs">Σ²RR = cov_RR(data_stations, K)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/correlations.jl#L55-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.Σ_Spearman2Pearson" href="#StochasticWeatherGenerators.Σ_Spearman2Pearson"><code>StochasticWeatherGenerators.Σ_Spearman2Pearson</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σ_Spearman2Pearson(M::AbstractMatrix)</code></pre><p>Compute the Pearson correlation coefficient i.e. the classic one from the Spearman correlation #TODO Add ref</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/correlations.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.Σ_Kendall2Pearson" href="#StochasticWeatherGenerators.Σ_Kendall2Pearson"><code>StochasticWeatherGenerators.Σ_Kendall2Pearson</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σ_Kendall2Pearson(M::AbstractMatrix)</code></pre><p>Compute the Pearson correlation coefficient i.e. the classic one from the Kendall correlation #TODO Add ref</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/correlations.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.joint_rain" href="#StochasticWeatherGenerators.joint_rain"><code>StochasticWeatherGenerators.joint_rain</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">joint_rain(M::AbstractMatrix, j1::Integer, j2::Integer, r = 0)</code></pre><p>Select all the rows of <code>M</code> with values for (two) columns above some value <code>r</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/rain/correlations.jl#L3-L6">source</a></section></article><h3 id="Map-utilities"><a class="docs-heading-anchor" href="#Map-utilities">Map utilities</a><a id="Map-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Map-utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.distance_x_to_y" href="#StochasticWeatherGenerators.distance_x_to_y"><code>StochasticWeatherGenerators.distance_x_to_y</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_x_to_y</code></pre><p>Distance in km between two stations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/data/stations.jl#L16-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.dms_to_dd" href="#StochasticWeatherGenerators.dms_to_dd"><code>StochasticWeatherGenerators.dms_to_dd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dms_to_dd(l)</code></pre><p>Convert Degrees Minutes Seconds to Decimal Degrees. Inputs are strings of the form</p><ul><li>LAT    : Latitude in degrees:minutes:seconds (+: North, -: South)</li><li>LON    : Longitude in degrees:minutes:seconds (+: East, -: West)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/data/stations.jl#L2-L7">source</a></section></article><h3 id="Data-manipulation"><a class="docs-heading-anchor" href="#Data-manipulation">Data manipulation</a><a id="Data-manipulation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-manipulation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.collect_data_ECA" href="#StochasticWeatherGenerators.collect_data_ECA"><code>StochasticWeatherGenerators.collect_data_ECA</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collect_data_ECA(STAID::Integer, path::String, var::String=&quot;RR&quot;; skipto=19, header = 18)</code></pre><p><code>path</code> gives the path where all data files are stored in a vector</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/data/extracting.jl#L16-L19">source</a></section><section><div><pre><code class="language-julia hljs">collect_data_ECA(STAID, date_start::Date, date_end::Date, path::String, var::String=&quot;RR&quot;; portion_valid_data=1, skipto=19, header = 18, return_nothing = true)</code></pre><ul><li><code>path</code> gives the path where all data files are stored in a vector</li><li>Filter the <code>DataFrame</code> s.t. <code>date_start ≤ :DATE ≤ date_end</code></li><li>var = &quot;RR&quot;, &quot;TX&quot; etc.</li><li><code>portion_valid_data</code> is the portion of valid data we are ok with. If we don&#39;t want any missing, fix it to <code>1</code>.</li><li><code>skipto</code> and <code>header</code> for <code>csv</code> files with meta informations/comments at the beginning of files. See <code>CSV.jl</code>.</li><li><code>return_nothing</code> if <code>true</code> it will return <code>nothing</code> is the file does not exists or does not have enough valid data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/data/extracting.jl#L29-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.select_in_range_df" href="#StochasticWeatherGenerators.select_in_range_df"><code>StochasticWeatherGenerators.select_in_range_df</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">select_in_range_df(datas, start_Date, interval_Date, [portion])</code></pre><p>Select station with some data availability in dates and quality (portion of valid data).  Input is a <code>vector</code> (array) of <code>DataFrame</code> (one for each station for example) or a <code>Dict</code> of <code>DataFrame</code>. If <code>0 &lt; portion ≤ 1</code> is specified, it will authorize some portion of data to be missing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/data/extracting.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.shortname" href="#StochasticWeatherGenerators.shortname"><code>StochasticWeatherGenerators.shortname</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shortname(name::String)</code></pre><p>Experimental function that returns only the most relevant part of a station name.</p><pre><code class="language-julia hljs">long_name = &quot;TOULOUSE-BLAGNAC&quot;
shortname(long_name) # &quot;TOULOUSE&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/data/extracting.jl#L78-L85">source</a></section></article><h3 id="Generic-utilities"><a class="docs-heading-anchor" href="#Generic-utilities">Generic utilities</a><a id="Generic-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Generic-utilities" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticWeatherGenerators.my_color" href="#StochasticWeatherGenerators.my_color"><code>StochasticWeatherGenerators.my_color</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">my_color(k, K)</code></pre><p>Convenience for plot colors pattern and hidden states to blue for k=1 (∼wetter) and orange for k=K (∼driest)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dmetivie/StochasticWeatherGenerators.jl/blob/add3f79643d49c04d5be68e7cda5b9d727bf3f0d/src/utilities.jl#L19-L22">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="examples/tuto_paper/">Multisite daily Stochastic Weather Generator »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 13 September 2024 14:10">Friday 13 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
